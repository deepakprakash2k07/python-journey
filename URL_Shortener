import hashlib
import json
import os

FILENAME = "urls.json"

def load_urls():
    if os.path.exists(FILENAME):
        with open(FILENAME, "r") as file:
            return json.load(file)
    return {}

def save_urls(data):
    with open(FILENAME, "w") as file:
        json.dump(data, file, indent=4)

def shorten_url(long_url):
    short_code = hashlib.md5(long_url.encode()).hexdigest()[:6]
    urls = load_urls()
    urls[short_code] = long_url
    save_urls(urls)
    return short_code

def retrieve_url(code):
    urls = load_urls()
    return urls.get(code, "URL not found")

while True:
    print("1. Shorten URL")
    print("2. Retrieve URL")
    print("3. Exit")

    choice = input("Enter choice: ")

    if choice == "1":
        url = input("Enter long URL: ")
        code = shorten_url(url)
        print("Short URL code:", code)
    elif choice == "2":
        code = input("Enter short code: ")
        print("Original URL:", retrieve_url(code))
    elif choice == "3":
        break
    else:
        print("Invalid choice")
